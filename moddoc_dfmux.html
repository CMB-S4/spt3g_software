<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>dfmux &#8212; SPT3G Software  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css?v=0f882399" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="examples" href="moddoc_examples.html" />
    <link rel="prev" title="core" href="moddoc_core.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="moddoc_examples.html" title="examples"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="moddoc_core.html" title="core"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SPT3G Software  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">dfmux</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="dfmux">
<h1>dfmux<a class="headerlink" href="#dfmux" title="Link to this heading">¶</a></h1>
<p>dfmux contains code and dataclasses to collect and store data from the DfMux system, particulary focusing on the ICE system used for SPT3G and PB2. A general overview of how the modules here interact can be found in the <a class="reference internal" href="dataacquisition.html"><span class="doc">Data Acquisition</span></a> section of the manual.</p>
<section id="modules-in-spt3g-dfmux">
<h2>Modules in spt3g.dfmux<a class="headerlink" href="#modules-in-spt3g-dfmux" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#spt3g-dfmux-hardwaremaptools-dfmlhardwaremapinjector">spt3g.dfmux.HardwareMapTools.DfmlHardwareMapInjector</a></p></li>
<li><p><a class="reference internal" href="#spt3g-dfmux-hardwaremaptools-generatefakehardwaremap">spt3g.dfmux.HardwareMapTools.GenerateFakeHardwareMap</a></p></li>
<li><p><a class="reference internal" href="#spt3g-dfmux-hardwaremaptools-pydfmuxbolometerpropertiesinjector">spt3g.dfmux.HardwareMapTools.PyDfMuxBolometerPropertiesInjector</a></p></li>
<li><p><a class="reference internal" href="#spt3g-dfmux-hardwaremaptools-pydfmuxwiringmapinjector">spt3g.dfmux.HardwareMapTools.PyDfMuxWiringMapInjector</a></p></li>
<li><p><a class="reference internal" href="#spt3g-dfmux-housekeeping-housekeepingconsumer">spt3g.dfmux.Housekeeping.HousekeepingConsumer</a></p></li>
<li><p><a class="reference internal" href="#spt3g-dfmux-housekeeping-periodichousekeepingcollector">spt3g.dfmux.Housekeeping.PeriodicHousekeepingCollector</a></p></li>
<li><p><a class="reference internal" href="#spt3g-dfmux-legacyhousekeeping-legacyhousekeepingconsumer">spt3g.dfmux.LegacyHousekeeping.LegacyHousekeepingConsumer</a></p></li>
<li><p><a class="reference internal" href="#spt3g-dfmux-scantools-fixedlengthscans">spt3g.dfmux.ScanTools.FixedLengthScans</a></p></li>
<li><p><a class="reference internal" href="#spt3g-dfmux-unittransforms-converttimestreamunits">spt3g.dfmux.unittransforms.ConvertTimestreamUnits</a></p></li>
</ul>
<p id="spt3g-dfmux-hardwaremaptools-dfmlhardwaremapinjector"><strong>spt3g.dfmux.HardwareMapTools.DfmlHardwareMapInjector</strong></p>
<dl class="simple">
<dt><em>Constructor:</em></dt><dd><p><code class="docutils literal notranslate"><span class="pre">DfmlHardwareMapInjector(self,</span> <span class="pre">dfml_hwm)</span></code></p>
</dd>
</dl>
<p id="spt3g-dfmux-hardwaremaptools-generatefakehardwaremap"><strong>spt3g.dfmux.HardwareMapTools.GenerateFakeHardwareMap</strong></p>
<p>Inserts a fake hardware map into the data stream. Takes a wiring frame as an argument to the constructor, which it will inject before any other frames.</p>
<dl class="simple">
<dt><em>Constructor:</em></dt><dd><p><code class="docutils literal notranslate"><span class="pre">GenerateFakeHardwareMap(self,</span> <span class="pre">frame)</span></code></p>
</dd>
</dl>
<p id="spt3g-dfmux-hardwaremaptools-pydfmuxbolometerpropertiesinjector"><strong>spt3g.dfmux.HardwareMapTools.PyDfMuxBolometerPropertiesInjector</strong></p>
<p>Insert a calibration frame following any wiring frame containing a
BolometerPropertiesMap named “NominalBolometerProperties” that has
the properties of each bolometer as defined by the given pydfmux
hardware map.</p>
<dl class="simple">
<dt><em>Definition:</em></dt><dd><p><code class="docutils literal notranslate"><span class="pre">PyDfMuxBolometerPropertiesInjector(frame,</span> <span class="pre">pydfmux_hwm=None,</span> <span class="pre">angle_per_mm=7.305948248848263e-05)</span></code></p>
</dd>
</dl>
<p id="spt3g-dfmux-hardwaremaptools-pydfmuxwiringmapinjector"><strong>spt3g.dfmux.HardwareMapTools.PyDfMuxWiringMapInjector</strong></p>
<p>Insert a wiring map derived from a pydfmux hardware map into the data
stream ahead of what would otherwise be the first frame.</p>
<p>Optionally filter for detectors described by the mask in &lt;pathstring&gt;
(see pydfmux documentation for hwm.channel_maps_from_pstring()) and
detectors in one of the states identified by the state argument.</p>
<dl class="simple">
<dt><em>Constructor:</em></dt><dd><p><code class="docutils literal notranslate"><span class="pre">PyDfMuxWiringMapInjector(self,</span> <span class="pre">pydfmux_hwm,</span> <span class="pre">pathstring=None,</span> <span class="pre">state=[])</span></code></p>
</dd>
</dl>
<p id="spt3g-dfmux-housekeeping-housekeepingconsumer"><strong>spt3g.dfmux.Housekeeping.HousekeepingConsumer</strong></p>
<p>Collect housekeeping data from the mux boards defined in the wiring map.
Will add a key called ‘DfMuxHousekeeping’ to any housekeeping frame that
goes by containing the data as of the arrival of the housekeeping frame.
Use in conjunction with a dfmux.PeriodicHousekeepingCollector to get
data at fixed intervals.</p>
<p>Also emits a Wiring frame from the housekeeping data.  This requires a
recent (as of November 2018) version of pydfmux in order to read mapped
channel names from each board.  If ignore_wiring=False, assumes that
the wiring map is handled by a separate process.</p>
<p>If collecting real-time data, you may want to set subprocess=True when
adding this module.</p>
<dl class="simple">
<dt><em>Constructor:</em></dt><dd><p><code class="docutils literal notranslate"><span class="pre">HousekeepingConsumer(self,</span> <span class="pre">ignore_wiring=False)</span></code></p>
</dd>
</dl>
<p id="spt3g-dfmux-housekeeping-periodichousekeepingcollector"><strong>spt3g.dfmux.Housekeeping.PeriodicHousekeepingCollector</strong></p>
<p>Inserts housekeeping frames every N timepoints.</p>
<dl class="simple">
<dt><em>Constructor:</em></dt><dd><p><code class="docutils literal notranslate"><span class="pre">PeriodicHousekeepingCollector(self,</span> <span class="pre">N=15200)</span></code></p>
</dd>
</dl>
<p id="spt3g-dfmux-legacyhousekeeping-legacyhousekeepingconsumer"><strong>spt3g.dfmux.LegacyHousekeeping.LegacyHousekeepingConsumer</strong></p>
<p>Collect housekeeping data from the legacy (i.e. SPTpol-ish) mux boards
defined in the wiring map. Will add a key called ‘DfMuxHousekeeping’ to
any housekeeping frame that goes by containing the data as of the arrival
of the housekeeping frame. Use in conjunction with a
dfmux.PeriodicHousekeepingCollector to get data at fixed intervals.</p>
<p>If collecting real-time data, you may want to set subprocess=True when
adding this module.</p>
<dl class="simple">
<dt><em>Constructor:</em></dt><dd><p><code class="docutils literal notranslate"><span class="pre">LegacyHousekeepingConsumer(self)</span></code></p>
</dd>
</dl>
<p id="spt3g-dfmux-scantools-fixedlengthscans"><strong>spt3g.dfmux.ScanTools.FixedLengthScans</strong></p>
<p>Makes scans of length N timepoints.</p>
<dl class="simple">
<dt><em>Constructor:</em></dt><dd><p><code class="docutils literal notranslate"><span class="pre">FixedLengthScans(self,</span> <span class="pre">N=1000)</span></code></p>
</dd>
</dl>
<p id="spt3g-dfmux-unittransforms-converttimestreamunits"><strong>spt3g.dfmux.unittransforms.ConvertTimestreamUnits</strong></p>
<p>Changes timestream units from one set of units (e.g. ADC counts) to
another (e.g. Power). Currents and power are time averaged quantities
(i.e. currents give RMS values).</p>
<p>Note that this does not handle conversions to on-sky quantities (e.g. K_cmb)</p>
<dl>
<dt><em>Constructor:</em></dt><dd><p><code class="docutils literal notranslate"><span class="pre">ConvertTimestreamUnits(self,</span> <span class="pre">Input='RawTimestreams',</span> <span class="pre">Output='CalTimestreams',</span> <span class="pre">Units=spt3g._libcore.G3TimestreamUnits.Power,</span> <span class="pre">SkipUncalibratable=False,</span> <span class="pre">KeepConversionsForObservation=True)</span></code></p>
</dd>
<dt><em>Constructor:</em></dt><dd><p>Copy data in the timestream map Input to the timestream map Output,
converting the units from whatever they were to those specified by
Units.</p>
<p>If SkipUncalibratable is true, copy timestreams for which the
unit conversions could not be evaluated into the output timestream
in their original units. If false, throws an exception if this occurs.</p>
<p>If KeepConversionsForObservation is True (default), conversion factors
will only be evaluated once per observation. Note that this will cause
the wrong conversions to be applied if any parameters of the mux system
are modified during the observation but will substantially increase
performance.</p>
</dd>
</dl>
</section>
<section id="functions-in-spt3g-dfmux">
<h2>Functions in spt3g.dfmux<a class="headerlink" href="#functions-in-spt3g-dfmux" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#spt3g-dfmux-hardwaremaptools-pathstringforbolo">spt3g.dfmux.HardwareMapTools.PathStringForBolo</a></p></li>
<li><p><a class="reference internal" href="#spt3g-dfmux-housekeeping-housekeepingforbolo">spt3g.dfmux.Housekeeping.HousekeepingForBolo</a></p></li>
<li><p><a class="reference internal" href="#spt3g-dfmux-unittransforms-get-timestream-unit-conversion">spt3g.dfmux.unittransforms.get_timestream_unit_conversion</a></p></li>
</ul>
<p id="spt3g-dfmux-hardwaremaptools-pathstringforbolo"><strong>spt3g.dfmux.HardwareMapTools.PathStringForBolo</strong></p>
<p>Obtain the channel pathstring for a bolometer named “bolo”
using the passed wiring map.</p>
<dl class="simple">
<dt><em>Definition:</em></dt><dd><p><code class="docutils literal notranslate"><span class="pre">PathStringForBolo(wiringmap,</span> <span class="pre">bolo)</span></code></p>
</dd>
</dl>
<p id="spt3g-dfmux-housekeeping-housekeepingforbolo"><strong>spt3g.dfmux.Housekeeping.HousekeepingForBolo</strong></p>
<p>Obtain the channel housekeeping information for a bolometer named “bolo”
using the passed housekeeping and wiring maps.</p>
<p>If all_hk is True, returns a tuple of the (board, mezz, module, channel)
HK data instead of just the channel.</p>
<dl class="simple">
<dt><em>Definition:</em></dt><dd><p><code class="docutils literal notranslate"><span class="pre">HousekeepingForBolo(hkmap,</span> <span class="pre">wiringmap,</span> <span class="pre">bolo,</span> <span class="pre">all_hk=False)</span></code></p>
</dd>
</dl>
<p id="spt3g-dfmux-unittransforms-get-timestream-unit-conversion"><strong>spt3g.dfmux.unittransforms.get_timestream_unit_conversion</strong></p>
<p>Return the scalar conversion factor to move timestream data from a
given system of units (Power, Resistance, Current, Counts) to another one.
Requires a wiring map and recent housekeeping data.
Returned quantities are RMS for currents and time-averaged for power.</p>
<p>Note that this does not handle conversions to on-sky quantities (e.g. K_cmb)</p>
<dl class="simple">
<dt><em>Definition:</em></dt><dd><p><code class="docutils literal notranslate"><span class="pre">get_timestream_unit_conversion(from_units,</span> <span class="pre">to_units,</span> <span class="pre">bolo,</span> <span class="pre">wiringmap=None,</span> <span class="pre">hkmap=None,</span> <span class="pre">system=None,</span> <span class="pre">tf=None)</span></code></p>
</dd>
</dl>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">dfmux</a><ul>
<li><a class="reference internal" href="#modules-in-spt3g-dfmux">Modules in spt3g.dfmux</a></li>
<li><a class="reference internal" href="#functions-in-spt3g-dfmux">Functions in spt3g.dfmux</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="moddoc_core.html"
                          title="previous chapter">core</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="moddoc_examples.html"
                          title="next chapter">examples</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/moddoc_dfmux.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="moddoc_examples.html" title="examples"
             >next</a> |</li>
        <li class="right" >
          <a href="moddoc_core.html" title="core"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SPT3G Software  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">dfmux</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright .
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    </div>
  </body>
</html>