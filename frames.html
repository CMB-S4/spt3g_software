<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Frames &#8212; SPT3G Software  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css?v=279e0f84" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Logging" href="logging.html" />
    <link rel="prev" title="Modules" href="modules.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="logging.html" title="Logging"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="modules.html" title="Modules"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SPT3G Software  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Frames</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="frames">
<h1><a class="toc-backref" href="#id1" role="doc-backlink">Frames</a><a class="headerlink" href="#frames" title="Link to this heading">¶</a></h1>
<p>The basic unit of data processing is the frame. Each frame is a free-form mapping from strings to data of a type derived from G3FrameObject. In general, they behave as Python dictionaries. Wrappers are provided for Python plain-old-data types (numbers, strings, etc.) so that they can be used directly.</p>
<p>Frames have fast serialization to and from disk (see the G3Reader and G3Writer modules in <a class="reference internal" href="fileio.html"><span class="doc">File IO</span></a>) with built-in data integrity protection. This serialization is accessible programmatically in Python through the Python pickle libraries, which are overridden to use the internal serialization.</p>
<p>Each frame has a type defined under the <code class="docutils literal notranslate"><span class="pre">core.G3FrameType</span></code> namespace. These are meant to indicate different types of data (calibration vs. scan data, for example) and, in general, many types of frames will be interleaved in the same data stream. A good general rule for whether data should be in a different frame type is to consider the rates at which the data change: data that change at the same speed (e.g. bolometer data and pointing) should share a frame, while data that change at different speeds (e.g. calibration constants and bolometer data) should be separated.</p>
<p>Each frame also has a <code class="docutils literal notranslate"><span class="pre">._filename</span></code> attribute, which is set when frames are read in using the <code class="docutils literal notranslate"><span class="pre">core.G3Reader</span></code> pipeline module with the <code class="docutils literal notranslate"><span class="pre">track_filename</span></code> option set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. This attribute is not serialized with the frame, so will be an empty string when used with pickling or multiprocessing.  This attribute is fragile and should not be relied upon for production code.</p>
<p>A brief description of the intention of each frame type follows along with a table containing a representative minimal set of data likely to be contained by a frame of a given type. The list is neither exhaustive nor truly minimal: other data can and will be present and some of the data listed here may have been removed or renamed. Neither is this an exhaustive list of frame types: any single character code can be [ab]used as a frame type for special purpose tools.</p>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#frames" id="id1">Frames</a></p>
<ul>
<li><p><a class="reference internal" href="#scan" id="id2">Scan</a></p></li>
<li><p><a class="reference internal" href="#pipelineinfo" id="id3">PipelineInfo</a></p></li>
<li><p><a class="reference internal" href="#timepoint" id="id4">Timepoint</a></p></li>
<li><p><a class="reference internal" href="#housekeeping" id="id5">Housekeeping</a></p></li>
<li><p><a class="reference internal" href="#map" id="id6">Map</a></p></li>
<li><p><a class="reference internal" href="#calibration" id="id7">Calibration</a></p></li>
<li><p><a class="reference internal" href="#observation" id="id8">Observation</a></p></li>
<li><p><a class="reference internal" href="#wiring" id="id9">Wiring</a></p></li>
<li><p><a class="reference internal" href="#gcpslow" id="id10">GcpSlow</a></p></li>
<li><p><a class="reference internal" href="#endprocessing" id="id11">EndProcessing</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="scan">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Scan</a><a class="headerlink" href="#scan" title="Link to this heading">¶</a></h2>
<p>Scan frames are the most common unit of data for analysis. They contain the data from a single left-to-right (or right-to-left) scan of the telescope. Where quantities are bolometer-indexed, the names match those in the Wiring map.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ACUStatus</p></td>
<td><p>ACUStatusVector</p></td>
<td><p>Sequences of gcp.ACUStatus objects containing the ACU state readout during the scan</p></td>
</tr>
<tr class="row-odd"><td><p>SourceName</p></td>
<td><p>G3String</p></td>
<td><p>Name of the source being observed</p></td>
</tr>
<tr class="row-even"><td><p>BoresightAz</p></td>
<td><p>G3Timestream</p></td>
<td><p>Telescope azimuth as a function of time</p></td>
</tr>
<tr class="row-odd"><td><p>BoresightEl</p></td>
<td><p>G3Timestream</p></td>
<td><p>Telescope elevation as a function of time</p></td>
</tr>
<tr class="row-even"><td><p>RawTimestreams_I</p></td>
<td><p>G3TimestreamMap</p></td>
<td><p>Raw (counts) timestreams from detectors, indexed by bolometer, I modulation</p></td>
</tr>
<tr class="row-odd"><td><p>RawTimestreams_Q</p></td>
<td><p>G3TimestreamMap</p></td>
<td><p>Raw (counts) timestreams from detectors, indexed by bolometer, Q modulation</p></td>
</tr>
<tr class="row-even"><td><p>CalTimestreams</p></td>
<td><p>G3TimestreamMap</p></td>
<td><p>Bolometer timestreams with some useful calibration applied (not present in raw data)</p></td>
</tr>
<tr class="row-odd"><td><p>TimestreamWeights</p></td>
<td><p>G3MapDouble</p></td>
<td><p>Floating point weights for each timestream, indexed by bolometer (not present in raw data)</p></td>
</tr>
<tr class="row-even"><td><p>ScanNumber</p></td>
<td><p>G3Int</p></td>
<td><p>Sequence number of the current scan within an observation</p></td>
</tr>
<tr class="row-odd"><td><p>Flags</p></td>
<td><p>G3MapVectorString</p></td>
<td><p>List of detectors with exceptional conditions. Indexed by bolometer ID. Each element is a list of strings that provides a description of the condition[s] that caused the detector to be flagged (not present in raw data).</p></td>
</tr>
<tr class="row-even"><td><p>Turnaround</p></td>
<td><p>G3Bool</p></td>
<td><p>Present and set to True if scan is a turnaround or otherwise is not a constant velocity scan. Absent otherwise.</p></td>
</tr>
<tr class="row-odd"><td><p>TrakerStatus</p></td>
<td><p>TrackerStatus</p></td>
<td><p>Composite tracker status information at all points during the scan.</p></td>
</tr>
<tr class="row-even"><td><p>DfMuxHousekeeping</p></td>
<td><p>DfMuxHousekeepingMap</p></td>
<td><p>Tree containing housekeeping data and configuration from the boards connected to the readout system, indexed by board IP address</p></td>
</tr>
<tr class="row-odd"><td><p>CalibratorOn</p></td>
<td><p>G3Timestream</p></td>
<td><p>Timestream of the calibrator sync signal. Set to 1 if the sync line is high and 0 otherwise. NaN if no readout.</p></td>
</tr>
<tr class="row-even"><td><p>GCPFeatureBits</p></td>
<td><p>G3VectorString</p></td>
<td><p>Strings describing the GCP flags field.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="pipelineinfo">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">PipelineInfo</a><a class="headerlink" href="#pipelineinfo" title="Link to this heading">¶</a></h2>
<p>PipelineInfo frames contain information on the processing applied to make the remainder of the data. They typically occur at the beginning of the data stream and are automatically inserted by G3Pipeline, if not previously present. The frame will contain at least one element of type G3PipelineInfo that gives information on the version of the software that made the data and the configuration of all modules and/or segments added to the pipeline. Other data (G3PipelineInfo from previous scripts, configuration information added by other modules) may also be present.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>22-May-2019:18:42:15.335969000</p></td>
<td><p>G3PipelineInfo</p></td>
<td><p>Configuration information of the pipeline that produced an object. Added automatically. The key name is a timestamp indicating the time at which the software began running.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="timepoint">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Timepoint</a><a class="headerlink" href="#timepoint" title="Link to this heading">¶</a></h2>
<p>Timepoint frames include sample-by-sample data from the mux system. They are emitted directly by the DfMuxBuilder as part of primary data acquisition and are generally not seen outside the South Pole or the lab. These are transformed into <a class="reference internal" href="#scan">Scan</a> frames by DfMuxCollator.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>EventHeader</p></td>
<td><p>G3Time</p></td>
<td><p>Time of the sample</p></td>
</tr>
<tr class="row-odd"><td><p>DfMux</p></td>
<td><p>DfMuxMetaSample</p></td>
<td><p>Tree containing data from the boards connected to the readout system, indexed by board IP address</p></td>
</tr>
</tbody>
</table>
</section>
<section id="housekeeping">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Housekeeping</a><a class="headerlink" href="#housekeeping" title="Link to this heading">¶</a></h2>
<p>Contains housekeeping data. Issued periodically when housekeeping data is taken. Like <a class="reference internal" href="#timepoint">Timepoint</a> frames, these are rolled into <a class="reference internal" href="#scan">Scan</a> frames during processing and do not appear in general in stored data.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>DfMuxHousekeeping</p></td>
<td><p>DfMuxHousekeepingMap</p></td>
<td><p>Tree containing housekeeping data and configuration from the boards connected to the readout system, indexed by board IP address</p></td>
</tr>
</tbody>
</table>
</section>
<section id="map">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Map</a><a class="headerlink" href="#map" title="Link to this heading">¶</a></h2>
<p>Contains either the result of the map maker or the input to simulation.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Id</p></td>
<td><p>G3String</p></td>
<td><p>A string identifying the map for the various processing steps</p></td>
</tr>
<tr class="row-odd"><td><p>T</p></td>
<td><p>G3SkyMap</p></td>
<td><p>A map storing the intensity information (could be sky intensity or sky intensity x weight).  In the case of maps that store abstract information like apodization masks or point source masks, the data will also be stored under the T key.  The motivation being it makes it easy to have G3Modules operating on maps also work on these.</p></td>
</tr>
<tr class="row-even"><td><p>Q</p></td>
<td><p>G3SkyMap</p></td>
<td><p>A map storing the Q polarization information (could be sky Q or sky Q x weight)</p></td>
</tr>
<tr class="row-odd"><td><p>U</p></td>
<td><p>G3SkyMap</p></td>
<td><p>A map storing the u polarization information (could be sky U or sky U x weight)</p></td>
</tr>
<tr class="row-even"><td><p>Wpol</p></td>
<td><p>G3SkyMapWeights</p></td>
<td><p>If the frame contains polarized information, this stores the t/q/u covariances scaled by the individual detector weights</p></td>
</tr>
<tr class="row-odd"><td><p>Wunpol</p></td>
<td><p>G3SkyMapWeights</p></td>
<td><p>This stores the unpolarized weight information</p></td>
</tr>
</tbody>
</table>
</section>
<section id="calibration">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Calibration</a><a class="headerlink" href="#calibration" title="Link to this heading">¶</a></h2>
<p>This frame contains all measured calibration information (pointing, response, etc.) that may change when remeasured. It does <em>not</em> include static information describing how the instrument is set up (see <a class="reference internal" href="#wiring">Wiring</a> below).</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BolometerProperties</p></td>
<td><p>BolometerPropertiesMap</p></td>
<td><p>Measured non-configuration-dependent calibration properties of the instrument (pointing, pol efficiency, etc.), indexed by bolometer</p></td>
</tr>
<tr class="row-odd"><td><p>NominalBolometerProperties</p></td>
<td><p>BolometerPropertiesMap</p></td>
<td><p>As above, but what those properties were meant to be.</p></td>
</tr>
<tr class="row-even"><td><p>TimeConst</p></td>
<td><p>G3MapDouble</p></td>
<td><p>Time constants of the detectors. These can change with the bias point. Should perhaps be moved to the InstrumentStatus frame.</p></td>
</tr>
<tr class="row-odd"><td><p>RCW38FluxCalibration</p></td>
<td><p>G3MapDouble</p></td>
<td><p>Observed flux of RCW38 per detector as a fraction of the calibrator response.</p></td>
</tr>
<tr class="row-even"><td><p>CalibratorResponse</p></td>
<td><p>G3MapDouble</p></td>
<td><p>Observed response to the most recent calibrator observation for each detector in Watts.</p></td>
</tr>
<tr class="row-odd"><td><p>CalibratorResponseSN</p></td>
<td><p>G3MapDouble</p></td>
<td><p>Signal to noise (in sigma) of the most recent calibrator observation in sigma.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="observation">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Observation</a><a class="headerlink" href="#observation" title="Link to this heading">¶</a></h2>
<p>Indicates global observation parameters. Changes at the beginning of a new observation, though, as with all metadata, repeat observation frames may appear during processing.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SourceName</p></td>
<td><p>G3String</p></td>
<td><p>Name of the source being observed</p></td>
</tr>
<tr class="row-odd"><td><p>ObservationNumber</p></td>
<td><p>G3Int</p></td>
<td><p>Sequence number of the current observation since we started recording such things</p></td>
</tr>
</tbody>
</table>
</section>
<section id="wiring">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Wiring</a><a class="headerlink" href="#wiring" title="Link to this heading">¶</a></h2>
<p>Gives the description of how the system is wired: notably, the connection between board serial number, module, channel and a bolometer ID.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>WiringMap</p></td>
<td><p>DfMuxWiringMap</p></td>
<td><p>Digest of the pydfmux channel mappings</p></td>
</tr>
<tr class="row-odd"><td><p>ReadoutSystem</p></td>
<td><p>G3String</p></td>
<td><p>Description of the type of readout system employed. Set to “DfMux” for SPTpol-style readout and “ICE” for 3G-style readout.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="gcpslow">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">GcpSlow</a><a class="headerlink" href="#gcpslow" title="Link to this heading">¶</a></h2>
<p>Holds all the GCP data sampled once per second. Like <a class="reference internal" href="#timepoint">Timepoint</a> and <a class="reference internal" href="#housekeeping">Housekeeping</a> frames, these data are consolidated in the Scan frames and do not appear in final data products. The data stored here begins as a strict copy of the GCP register map (see the GCP documentation for details, a few notable entries are summarized below). A few other keys are added transiently in the course of generating <a class="reference internal" href="#scan">Scan</a> frames.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>array</p></td>
<td><p>G3MapFrameObject</p></td>
<td><p>Most of the data stored by GCP</p></td>
</tr>
<tr class="row-odd"><td><p>antenna0</p></td>
<td><p>G3MapFrameObject</p></td>
<td><p>Telescope pointing information</p></td>
</tr>
</tbody>
</table>
</section>
<section id="endprocessing">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">EndProcessing</a><a class="headerlink" href="#endprocessing" title="Link to this heading">¶</a></h2>
<p>EndProcessing is a special-purpose frame emitted implicitly by G3Pipeline at the end of processing. No further frames will occur after this and reception of an EndProcessing frame is intended as a signal to modules that they should clear any internally buffered data and clean up.</p>
<p>EndProcessing frames should, in general, contain no data.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Frames</a><ul>
<li><a class="reference internal" href="#scan">Scan</a></li>
<li><a class="reference internal" href="#pipelineinfo">PipelineInfo</a></li>
<li><a class="reference internal" href="#timepoint">Timepoint</a></li>
<li><a class="reference internal" href="#housekeeping">Housekeeping</a></li>
<li><a class="reference internal" href="#map">Map</a></li>
<li><a class="reference internal" href="#calibration">Calibration</a></li>
<li><a class="reference internal" href="#observation">Observation</a></li>
<li><a class="reference internal" href="#wiring">Wiring</a></li>
<li><a class="reference internal" href="#gcpslow">GcpSlow</a></li>
<li><a class="reference internal" href="#endprocessing">EndProcessing</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="modules.html"
                          title="previous chapter">Modules</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="logging.html"
                          title="next chapter">Logging</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/frames.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="logging.html" title="Logging"
             >next</a> |</li>
        <li class="right" >
          <a href="modules.html" title="Modules"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SPT3G Software  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Frames</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright .
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.0.
    </div>
  </body>
</html>